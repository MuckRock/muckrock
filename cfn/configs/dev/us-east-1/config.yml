template: cfn/templates/ecs-service.template.yml
stack_name: django-media-browser-dev
region: us-east-1
context:
  name: django-media-browser
  environment: dev

  routing:
    is_public: false
    certificate: arn:aws:acm:us-east-1:566093341066:certificate/adf4c1f6-1a81-49b2-aa9c-7e84b0da5eb3
    dns:
      zone_apex: elections.aws.wapo.pub.
      domain: django-media-browser-dev.elections.aws.wapo.pub.

  # Required
  service:
    # Initial number of tasks to run, defaults to 2
    default_scale: 2

    health_check_path: /watchman/

    # health check info and defaults

    # health_check_interval_seconds: 10
    # healthy_threshold_count: 2
    # unhealthy_threshold_count: 6
    # health_check_timeout_seconds: 5

    # Not required, additional cloudformation properties
    # cfn_properties:

    # Not required, only needed if you access AWS resources with the task
    task_role:
      # Use this if the role was created in another cloudformation
      # import_role:
      policies:
        # List of policies
        - actions:
            - s3:*
            - ssm:GetParameter
          resources:
            - arn:aws:s3:::parler-data/*

  # Required
  container:
    name: django-media-browser
    port: 8000
    # Not required, map of environment variables
    environment:
      AWS_STORAGE_BUCKET_NAME: parler-data
      DJANGO_SETTINGS_MODULE: media-browser.settings.development

    # Not required, additional cloudformation properties
    cfn_properties:
      ExtraHosts:
        - Hostname: statsd
          IpAddress: 172.17.0.1

  # Not required, other companion containers
  # other_containers:
  #   - name:
  #     environment:
  #     cfn_properties:

params:
  # define the cluster name to run the service on
  ClusterName: newsroom-dev

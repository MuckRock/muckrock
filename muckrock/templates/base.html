{% load static from staticfiles %}
{% load compress %}
{% load render_bundle from webpack_loader %}
{% load hijack_tags %}
{% load opensearch_tags %}
<!doctype html>

<html lang="en-US">
  <head>
    <title>{% block title %}MuckRock{% endblock title %}</title>
    <meta charset="utf-8" />
    {% block description %}<meta name="description" content=""/>{% endblock description %}
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="google-site-verification" content="j3QyPvF_0QX1v2YTWeY0Al5JCiBVdxhDjJM5JgFkxVE" />
    <meta name="google-site-verification" content="4KnIEDr5Fi-PUL9klVnMlC2BMcStrUwQIj-4gMVfqjk" />
    {% block rss %}
    <link rel="alternate" type="application/rss+xml" title="MuckRock News Feed" href="{% url 'news-feed' %}" />
    {% endblock rss %}
    <!-- Load Assets -->
    <link rel="shortcut icon"       href="{% static 'icons/favicon.ico' %}" />
    <link rel="mask-icon"           href="{% static 'icons/favicon.svg' %}" color="#367AF0" />
    <link rel="apple-touch-icon"    href="{% static 'icons/logo.png' %}" />
    {% compress css %}
      <style type="text/css">
/* Typefaces are loaded inside the base template so that they can be referenced
   by the correct URL. In production, the typefaces should be served from a CDN. */
@font-face {
  font-family: 'Source Sans Pro';
  src: url("{% static 'fonts/SourceSansPro-Regular.ttf' %}");
  font-weight: 400;
  font-style: normal;
}
            @font-face {
              font-family: 'Source Sans Pro';
              src: url("{% static 'fonts/SourceSansPro-Italic.ttf' %}");
              font-weight: 400;
              font-style: italic;
            }
            @font-face {
              font-family: 'Source Sans Pro';
              src: url("{% static 'fonts/SourceSansPro-Semibold.ttf' %}");
              font-weight: 500;
              font-style: normal;
            }
            @font-face {
              font-family: 'Source Sans Pro';
              src: url("{% static 'fonts/SourceSansPro-SemiboldItalic.ttf' %}");
              font-weight: 500;
              font-style: italic;
            }
            @font-face {
              font-family: 'Source Code Pro';
              src: url("{% static 'fonts/SourceCodePro-Regular.ttf' %}");
              font-weight: normal;
              font-style: normal;
            }
      </style>
      <link rel="stylesheet" type="text/css" href="{% static 'autocomplete_light/style.css' %}" />
      <link rel="stylesheet" type="text/css" href="{% static 'hijack/hijack-styles.css' %}" />
      {% render_bundle 'main' 'css' %}
    {% endcompress %}
    {% block styles %}
    {% endblock %}
    <!-- Prefetch and Prerendering -->
    {% block prefetch %}
    {% endblock prefetch %}
    {% block prerender %}
    {% endblock prerender %}
    <!-- Facebook and Twitter Integration -->
    <!-- http://ogp.me & https://dev.twitter.com/docs/cards -->
    {% block open_graph %}
      <meta property="og:site_name" content="MuckRock" />
      <meta property="og:title" content="MuckRock" />
      <meta property="og:type" content="website" />
      <meta property="og:url" content="{{ request.build_absolute_uri }}" />
      <meta property="og:description" content="MuckRock is a collaborative news site that gives you the tools to hold the government accountable." />
      <meta property="og:image" content="{% static 'icons/logo.png' %}" />
    {% endblock open_graph %}
    {% block twitter_card %}
      <meta name="twitter:card" content="summary" />
      <meta name="twitter:site" content="@muckrock" />
      <meta name="twitter:title" content="MuckRock" />
      <meta name="twitter:description" content="MuckRock is a collaborative news site that gives you the tools to hold the government accountable." />
      <meta name="twitter:image:src" content="{% static 'icons/logo.png' %}" />
    {% endblock twitter_card %}
    {% opensearch_meta %}
    <script type="application/ld+json">
{ "@context" : "http://schema.org",
          "@type" : "Organization",
          "legalName" : "MuckRock Foundation",
          "url" : "https://www.muckrock.com/",
          "address" : {
            "@type" : "PostalAddress",
            "addressCountry" : "US",
            "addressLocality" : "Somerville",
            "addressRegion" : "MA",
            "postalCode" : "02144",
            "streetAddress" : "411A Highland Ave"
          },
          "contactPoint" : [{
            "@type" : "ContactPoint",
            "telephone" : "+1-617-299-1832",
            "email" : "info@muckrock.com",
            "contactType" : "customer service"
          }],
          "logo" : "https://cdn.muckrock.com/icons/logo.png",
          "sameAs" : [ "http://www.facebook.com/muckrock",
            "http://www.twitter.com/MuckRock",
            "https://en.wikipedia.org/wiki/MuckRock"]
        }
    </script>
    <script type="application/ld+json">
{
      "@context" : "http://schema.org",
      "@type" : "WebSite",
      "name" : "MuckRock Foundation",
      "url" : "https://www.muckrock.com/",
      "potentialAction" : {
      "@type" : "SearchAction",
      "target" : "https://www.muckrock.com/search/?q={search_term}",
      "query-input" : "required name=search_term"
      }
    }
    </script>
<!-- start Mixpanel --><script type="text/javascript">(function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
mixpanel.init("{{ mp_token }}", {debug:true});</script><!-- end Mixpanel -->
  </head>
  <body>
    {% hijack_notification %}
    {% block body %}
      <div class="container">
        <div id="modal-overlay"></div>
        {% include 'nav/header.html' %}
        {% if messages %}
          <ul class="messages nostyle">
            {% for message in messages %}
              <li>{% include 'lib/pattern/message.html' %}</li>
            {% endfor %}
          </ul>
        {% endif %}
        {% if user.profile.email_failed %}
          <div class="message warning">
            <span class="symbol">
              {% include "lib/component/icon/warning.svg" %}
            </span>
            <span class="text">
              <p>
                The last email we sent you bounced back.
                <a href="{% url "acct-settings" %}">Please update your email address.</a>
              </p>
            </span>
          </div>
        {% endif %}
        <div class="content">
          {% block content %}
          {% endblock content %}
        </div>
        {% include 'nav/footer.html' %}
      </div>
    {% endblock %}
    <!-- SCRIPTS -->
    <!-- Google Analytics -->
    <script>
      // Prevents Google Analytics from tracking events
      // on our development or staging servers.
      if (location.host == "www.muckrock.com") {
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-16635809-1', 'auto');
        // Track the account type of the current user
        {% if request.user.is_authenticated %}
          var dimensionValue = '{{request.user.profile.organization.plan}}';
        {% else %}
          var dimensionValue = 'anonymous';
        {% endif %}
        ga('set', 'dimension1', dimensionValue);
        // Track this pageview
        ga('send', 'pageview');
        // Track any server events
        {% if ga == 'request_purchase' %}
          ga('send', 'event', 'Requests', 'Purchase', 1);
        {% endif %}
        {% if ga == 'request_drafted' %}
          ga('send', 'event', 'Requests', 'Draft');
        {% endif %}
        {% if ga == 'request_submitted' %}
          ga('send', 'event', 'Requests', 'Submitted');
        {% endif %}
        {% if ga == "pro_started" %}
          ga('send', 'event', 'Account', 'Pro', 'Subscription');
        {% endif %}
        {% if ga == "pro_cancelled" %}
          ga('send', 'event', 'Account', 'Pro', 'Cancellation');
        {% endif %}
        {% if ga == "donation" %}
          ga('send', 'event', 'Donations', 'Donated', '', {{donated}});
        {% endif %}
      }
    </script>
    <!-- End Google Analytics -->
    <script>
      {% if mp_alias and request.user.is_authenticated %}
        mixpanel.alias("{{ request.user.pk }}");
        mixpanel.people.set_once({
          "Requests Filed": 0,
          "Assignments Completed": 0,
        })
      {% endif %}
      {% if request.user.is_authenticated %}
        mixpanel.identify("{{ request.user.pk }}");
      {% endif %}
      {% for event, props in mp_events %}
        mixpanel.track("{{ event }}", {{ props }});
        {% if event == "Request Submitted" %}
          mixpanel.people.increment("Requests Filed");
        {% endif %}
        {% if event == "Assignment Completed" %}
          mixpanel.people.increment("Assignments Completed");
        {% endif %}
      {% endfor %}
      {% if mp_charge %}
        mixpanel.people.track_charge({{ mp_charge }});
      {% endif %}
      {% if request.user.is_authenticated %}
        mixpanel.register({
          "Account Type": "{{ request.user.profile.organization.plan }}",
          "Date Joined": "{{ request.user.date_joined|date:"c" }}",
          {% if request.user.profile.organization %}
            "Organization": "{{ request.user.profile.organization.name }}",
          {% endif %}
        });
        mixpanel.people.set({
          "$email": "{{ request.user.email }}",
          "$name": "{{ request.user.profile.full_name }}",
          "Account Type": "{{ request.user.profile.organization.plan }}",
          "Date Joined": "{{ request.user.date_joined|date:"c" }}",
          {% if request.user.profile.organization %}
            "Organization": "{{ request.user.profile.organization.name }}",
          {% endif %}
        })
      {% endif %}
		</script>
    <script src="https://js.stripe.com/v3/"></script>
    {% block prescripts %}
    {% endblock prescripts %}
    {% compress js %}
      {% render_bundle 'main' 'js' %}
      <script type="text/javascript" src="{% static 'autocomplete_light/django_admin.js' %}"></script>
      <script type="text/javascript" src="{% static 'autocomplete_light/autocomplete.js' %}"></script>
      <script type="text/javascript" src="{% static 'autocomplete_light/widget.js' %}"></script>
      <script type="text/javascript" src="{% static 'autocomplete_light/addanother.js' %}"></script>
      <script type="text/javascript" src="{% static 'autocomplete_light/text_widget.js' %}"></script>
      <script type="text/javascript" src="{% static 'autocomplete_light/remote.js' %}"></script>
    {% endcompress %}
    {% block scripts %}
    {% endblock scripts %}
    <!-- END SCRIPTS -->
    {# iframe for OpenID Connect session management #}
    {% if request.session.session_state %}
      <iframe src="{% url "acct-rp-iframe" %}" frameborder="0" width="0" height="0"></iframe>
    {% endif %}
  </body>
</html>

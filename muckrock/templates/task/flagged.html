{% extends 'task/default.html' %}

{% block task-class %}
    flagged
{% endblock %}

{% block task-data %}
<dl class="task-data">
    {% if task.text %}
    <dt>Message</dt>
    <dd>{{task.text}}</dd>
    {% endif %}
    {% if task.user %}
    <dt>User</dt>
    <dd><a href="{% url 'admin:auth_user_change' task.user.pk %}">{{task.user.get_full_name}}</a></dd>
    {% endif %}
    {% if task.foia %}
    <dt>Request</dt>
    <dd><a href="{% url 'admin:foia_foiarequest_change' task.foia.pk %}">{{task.foia}}</a></dd>
    {% elif task.agency %}
    <dt>Agency</dt>
    <dd><a href="{% url 'admin:agency_agency_change' task.agency.pk %}">{{task.agency}}</a></dd>
    {% elif task.jurisdiction %}
    <dt>Jurisdiction</dt>
    <dd><a href="{% url 'admin:jurisdiction_jurisdiction_change' task.jurisdiction.pk %}">{{task.jurisidiction}}</a></dd>
    {% endif %}
</dl>
{% endblock %}

{% block task-extra-context %}
<div class="task-extra-context flag-response">
    <form method="POST" action="{{ endpoint }}">
        <header>
            <p>&crarr; Reply to {{task.user.first_name}} &lt;<a href="mailto:{{task.user.email}}">{{task.user.email}}</a>&gt;</p>
        </header>
        {% csrf_token %}
        <input type="hidden" name="task" value="{{task.pk}}">
        {{ flag_form.text }}
        <footer class="submission-control">
            <div class="checkbox-field">
                <input type="checkbox" name="resolve" id="resolve-with-reply" checked>
                <label for="resolve-with-reply">Resolve after sending</label>
            </div>
            <button type="submit" name="reply" value="true" class="primary">Reply</button>
        </footer>
    </form>
</div>
{% endblock %}
